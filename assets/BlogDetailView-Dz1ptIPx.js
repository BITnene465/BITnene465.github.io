import{d as w,r as b,j as $,c as o,F as _,f as v,n as x,a as e,t as r,o as t,_ as B,g as h,h as f,i as k,u as m,R as y,b as R,k as T,l as P,m as V}from"./index-DxjesfLk.js";import{l as S,a as D}from"./blogLoader-f9a2nd35.js";const E={class:"table-of-contents"},L={key:0},N=["href"],M={key:1,class:"no-toc"},O=w({__name:"BlogTableOfContents",props:{content:{}},setup(p){const n=p,i=b([]);function g(c){const d=/<h([1-6])[^>]*id=["']([^"']+)["'][^>]*>(.*?)<\/h\1>/gi,a=[...c.matchAll(d)],s=[];return a.forEach(l=>{const u=parseInt(l[1]),I=l[2],C=l[3].replace(/<[^>]*>/g,"");s.push({level:u,id:I,text:C})}),s}return $(()=>n.content,c=>{const d=g(c);i.value=d},{immediate:!0}),(c,d)=>(t(),o("div",E,[i.value.length>0?(t(),o("ul",L,[(t(!0),o(_,null,v(i.value,(a,s)=>(t(),o("li",{key:s,class:x(`level-${a.level}`)},[e("a",{href:`#${a.id}`},r(a.text),9,N)],2))),128))])):(t(),o("div",M," 此文章没有目录结构 "))]))}}),W=B(O,[["__scopeId","data-v-2938ba4b"]]),z={class:"related-posts"},F={key:0},H={class:"post-date"},j={key:1,class:"no-related"},A=w({__name:"BlogRelatedPosts",props:{currentPost:{}},setup(p){const n=p,i=b([]);async function g(){if(!n.currentPost)return;const d=(await S()).filter(a=>a.id!==n.currentPost.id).map(a=>{let s=0;return n.currentPost.categories.forEach(l=>{a.categories.includes(l)&&(s+=2)}),n.currentPost.keywords.forEach(l=>{a.keywords.includes(l)&&(s+=1)}),{...a,relevanceScore:s}}).filter(a=>a.relevanceScore>0).sort((a,s)=>s.relevanceScore-a.relevanceScore).slice(0,5);i.value=d}return $(()=>n.currentPost,()=>{g()},{immediate:!0}),(c,d)=>(t(),o("div",z,[i.value.length>0?(t(),o("ul",F,[(t(!0),o(_,null,v(i.value,a=>(t(),o("li",{key:a.id},[h(m(y),{to:`/blog/${a.id}`,class:"related-post-link"},{default:f(()=>[k(r(a.title),1)]),_:2},1032,["to"]),e("span",H,r(a.date),1)]))),128))])):(t(),o("div",j," 没有相关文章 "))]))}}),U=B(A,[["__scopeId","data-v-ced7a71d"]]),q={class:"blog-wrapper"},G={class:"blog-top-navigation"},J={key:0,class:"sidebar left-sidebar"},K={class:"sidebar-content"},Q={class:"sidebar-section"},X={class:"categories-list"},Y={class:"main-content"},Z={key:0,class:"loading"},ee={key:1,class:"not-found"},se={key:2,class:"post-content"},te={class:"post-meta"},oe={class:"date"},ne={class:"categories"},ae=["innerHTML"],le={class:"keywords"},ie={class:"post-navigation"},ce={key:1,class:"sidebar right-sidebar"},re={class:"sidebar-content"},de={class:"sidebar-section author-info"},ue={class:"author"},_e={class:"author-name"},ve={class:"sidebar-section"},he={class:"sidebar-section"},pe={class:"keywords-cloud"},ge=w({__name:"BlogDetail",setup(p){const n=b(null),i=b(!0),g=T(),c=b(window.innerWidth>=768);function d(){c.value=!c.value}return R(async()=>{const a=g.params.id;n.value=await D(a),i.value=!1,window.addEventListener("resize",()=>{window.innerWidth>=1024&&(c.value=!0)})}),(a,s)=>(t(),o("div",q,[e("div",G,[h(m(y),{to:"/blog",class:"back-button"},{default:f(()=>s[0]||(s[0]=[e("span",{class:"back-icon"},"←",-1),k(" 返回博客列表 ")])),_:1}),e("button",{class:"toggle-sidebar-button",onClick:d},r(c.value?"隐藏侧栏":"显示侧栏"),1)]),e("div",{class:x(["blog-container",{"sidebar-visible":c.value}])},[n.value&&!i.value?(t(),o("aside",J,[e("div",K,[s[2]||(s[2]=e("div",{class:"sidebar-header"},[e("h3",null,"文章目录")],-1)),h(W,{content:n.value.content||""},null,8,["content"]),e("div",Q,[s[1]||(s[1]=e("h4",null,"分类",-1)),e("div",X,[(t(!0),o(_,null,v(n.value.categories,l=>(t(),V(m(y),{key:l,to:`/blog?category=${encodeURIComponent(l)}`,class:"category-link"},{default:f(()=>[k(r(l),1)]),_:2},1032,["to"]))),128))])])])])):P("",!0),e("main",Y,[i.value?(t(),o("div",Z," 加载中... ")):n.value?(t(),o("article",se,[e("header",null,[e("h1",null,r(n.value.title),1),e("div",te,[e("span",oe,r(n.value.date),1),e("div",ne,[(t(!0),o(_,null,v(n.value.categories,(l,u)=>(t(),o("span",{key:u,class:"category"},r(l),1))),128))])])]),e("div",{class:"content",innerHTML:n.value.content},null,8,ae),e("footer",null,[e("div",le,[(t(!0),o(_,null,v(n.value.keywords,(l,u)=>(t(),o("span",{key:u,class:"keyword"}," #"+r(l),1))),128))]),e("div",ie,[h(m(y),{to:"/blog",class:"back-link"},{default:f(()=>s[3]||(s[3]=[k("返回文章列表")])),_:1})])])])):(t(),o("div",ee," 文章不存在或已被删除 "))]),n.value&&!i.value?(t(),o("aside",ce,[e("div",re,[e("div",de,[s[5]||(s[5]=e("h4",null,"关于作者",-1)),e("div",ue,[e("div",_e,r(n.value.author||"BITnene465"),1),s[4]||(s[4]=e("div",{class:"author-description"},"个人网站创建者",-1))])]),e("div",ve,[s[6]||(s[6]=e("h4",null,"相关文章",-1)),h(U,{currentPost:n.value},null,8,["currentPost"])]),e("div",he,[s[7]||(s[7]=e("h4",null,"关键词",-1)),e("div",pe,[(t(!0),o(_,null,v(n.value.keywords,(l,u)=>(t(),o("span",{key:u,class:"keyword-tag"}," #"+r(l),1))),128))])])])])):P("",!0)],2)]))}}),be=B(ge,[["__scopeId","data-v-670ce79d"]]),fe={class:"blog-detail-view"},ke=w({__name:"BlogDetailView",setup(p){return(n,i)=>(t(),o("div",fe,[h(be)]))}}),we=B(ke,[["__scopeId","data-v-fbbb2686"]]);export{we as default};
